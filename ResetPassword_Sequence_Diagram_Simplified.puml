@startuml Reset Password Sequence Diagram - Simplified
!theme plain
title Sequence Diagram - Reset Password Feature (Simplified)

participant "Client" as C
participant "ForgotPasswordPage" as FPP
participant "ForgotPasswordController" as FPC
participant "UserRepository" as UR
participant "EmailService" as ES
participant "ResetPasswordPage" as RPP
participant "ResetPasswordController" as RPC

== Phase 1: Forgot Password ==

C -> FPP: 1: enter email
C -> FPP: 2: submit request
activate FPP

FPP -> FPC: submit forgot password request
activate FPC

FPC -> UR: 3: findUserByEmail(email)
activate UR
UR --> FPC: 4: user data
deactivate UR

alt [User exists]
    FPC -> FPC: 5: generate reset token
    FPC -> ES: 6: send reset email
    activate ES
    ES --> FPC: 7: email sent
    deactivate ES
    
    FPC --> FPP: 8: success response
    deactivate FPC
    
    FPP -> C: 9: display success message
    deactivate FPP
    
else [User not found]
    FPC --> FPP: success response (security)
    deactivate FPC
    
    FPP -> C: display success message
    deactivate FPP
end

== Phase 2: Reset Password ==

C -> C: 10: click reset link
C -> RPP: 11: access reset page
activate RPP

C -> RPP: 12: enter new password
C -> RPP: 13: submit reset request
activate RPP

RPP -> RPC: submit reset request
activate RPC

RPC -> RPC: 14: validate token
RPC -> UR: 15: update password
activate UR
UR --> RPC: 16: password updated
deactivate UR

RPC --> RPP: 17: success response
deactivate RPC

RPP -> C: 18: redirect to login
deactivate RPP

@enduml 